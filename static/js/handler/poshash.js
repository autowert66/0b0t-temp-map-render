PosHashHandler.prototype=new BaseHandler;function PosHashHandler(){}PosHashHandler.prototype.create=function(){this.lastUpdate=0;const t=this.parseHash();this.gotoHash(t),this.updateHash();const o=()=>this.updateHash();this.ui.lmap.on("dragend",o),this.ui.lmap.on("zoomend",o)},PosHashHandler.prototype.onMapChange=function(t,o){this.updateHash()},PosHashHandler.prototype.parseHash=function(){if(!location.hash)return null;let o=location.hash.slice(1).split("/");return o.length!==6?null:(o=[o[0],...o.slice(1).map(Number)],o)},PosHashHandler.prototype.updateHash=function(){this.lastUpdate=Date.now();const t=this.ui.getCurrentMap(),o=this.ui.getCurrentRotation();let i=this.ui.latLngToMC(this.ui.lmap.getCenter(),this.ui.getCurrentMapConfig().worldSeaLevel);i=i.map(Math.round);const n=this.ui.lmap.getZoom();window.location.hash="#"+[t,o,n,...i].join("/")},PosHashHandler.prototype.gotoHash=function(t){if(!t)return;if(!(t[0]in this.ui.getMapConfigs())||!this.ui.getMapConfig(t[0]).rotations.includes(t[1]))return null;this.ui.setMapAndRotation(t[0],t[1]);const o=this.ui.mcToLatLng(t[3],t[4],t[5]);this.ui.lmap.setView(o,t[2])};
